<main class="container">
  <h1 class="general-title-margin">Checkout</h1>
  <ul class="steps list-inline">
    <li class="step active">
      <span class="step-number">1</span>
      <span class="step-text hidden-xs">Address</span></li>
    <li class="step-divider"></li>
    <li class="step">
      <span class="step-number">2</span>
      <span class="step-text hidden-xs">Delivery</span></li>
    <li class="step-divider"></li>
    <li class="step">
      <span class="step-number">3</span>
      <span class="step-text hidden-xs">Payment</span></li>
    <li class="step-divider"></li>
    <li class="step">
      <span class="step-number">4</span>
      <span class="step-text hidden-xs">Confirm</span></li>
    <li class="step-divider"></li>
    <li class="step">
      <span class="step-number">5</span>
      <span class="step-text hidden-xs">Complete</span></li>
  </ul>
  <div class="tab-content">
    <% if @cart_service.delivery_price.positive? %>
      <a href="/checkout_steps/checkout_confirm" class="general-back-link">
      <i class="fa fa-long-arrow-left mr-15"></i>Back to Confirm</a>
    <% end %>

    <div id="address" role="tabpanel" class="tab-pane fade in active general-main-wrap">
      <div class="hidden-xs hidden-sm">
        <div class="row">
          <div class="col-md-5">
            <h3 class="general-subtitle mt-0">Billing Address</h3>
          </div>
          <div class="col-md-5 col-md-offset-1">
            <h3 class="general-subtitle mt-0">Shipping Address</h3>
          </div>
        </div>
      </div>
      <div class="row">
        <%= form_tag('/addresses', method: :post) do %>
        <input type="hidden" name="address_type" value="billing">
        <input type="hidden" name="user_id" value="<%= current_user.id %>">
        <div class="col-md-5 mb-40">
          <div class="visible-xs visible-sm">
            <h3 class="general-subtitle mt-0">Billing Address</h3>
          </div>
          <div class="form-group">
            <label for="b_firstName" class="control-label input-label">First Name</label>
            <input value="<%= @billing.first_name %>" id="b_firstName" name="first_name"
              type="text" placeholder="Please enter your first name" class="form-control" required pattern="^[a-zA-Z]+$" maxlength="50"
              title="First Name" />
          </div>
          <div class="form-group">
            <label for="b_lastName" class="control-label input-label">Last Name</label>
            <input value="<%= @billing.last_name %>" id="b_lastName" name="last_name"
              type="text" placeholder="Last Name" class="form-control" required pattern="^[A-Za-z]+$" maxlength="50"
              title="Last Name" />
          </div>
          <div class="form-group">
            <label for="b_address" class="control-label input-label">Address</label>
            <input value="<%= @billing.address %>" id="b_address" name="address" type="text"
              placeholder="Address" class="form-control" required pattern="^[a-zA-Z0-9\s,-]+$" maxlength="50"
              title="Address" />
          </div>
          <div class="form-group">
            <label for="b_city" class="control-label input-label">City</label>
            <input value="<%= @billing.city %>" id="b_city" name="city" type="text"
              placeholder="City" class="form-control" required pattern="^[a-zA-Z]+$" maxlength="50"
              title="City" />
          </div>
          <div class="form-group">
            <label for="b_zip" class="control-label input-label">Zip</label>
            <input value="<%= @billing.zip %>" id="b_zip" name="zip" type="text"
              placeholder="Zip" class="form-control" required pattern="^[0-9-]+$" maxlength="8"
              title="Zip" />
          </div>
          <div class="form-group">
            <label for="b_сountry" class="control-label input-label">Country</label>
            <select id="b_country" name="country" placeholder="Country" class="form-control" required pattern="^[A-Za-z]+$"
              maxlength="50" title="Country"
              <%=country_select :country, @billing.country %>
            </select></div>
          <div class="form-group mb-60">
            <label for="b_phone" class="control-label input-label">Phone</label>
            <input value="<%= @billing.phone %>" id="b_phone" name="phone" type="tel"
              placeholder="Phone" class="form-control" required pattern="^\+\d{3,15}$" maxlength="15"
              title="Phone" />
          </div>
          <div class="text-center general-text-align">
            <button id="b_commit" type="submit" class="btn btn-default mb-20" name="commit" value="Save">Save</button></div>
        </div>
        <% end %>

        <%= form_tag('/addresses', method: :post) do %>
        <input type="hidden" name="address_type" value="shipping">
        <input type="hidden" name="user_id" value="<%= current_user.id %>">
        <div class="col-md-5 col-md-offset-1 mb-25">
          <div class="visible-xs visible-sm">
            <h3 class="general-subtitle mt-0">Shipping Address</h3>
          </div>
          <div class="form-group">
            <label for="sh_firstName" class="control-label input-label">First Name</label>
            <input value="<%= @shipping.first_name %>" id="sh_firstName" name="first_name"
              type="text" placeholder="First Name" class="form-control" pattern="^[a-zA-Z]+$" maxlength="50"
              title="First Name" />
          </div>
          <div class="form-group">
            <label for="sh_lastName" class="control-label input-label">Last Name</label>
            <input value="<%= @shipping.last_name %>" id="sh_lastName" name="last_name"
              type="text" placeholder="Last Name" class="form-control" pattern="^[A-Za-z]+$" maxlength="50"
              title="Last Name" />
          </div>
          <div class="form-group">
            <label for="sh_address" class="control-label input-label">Address</label>
            <input value="<%= @shipping.address %>" id="sh_address" name="address" type="text"
              placeholder="Address" class="form-control" pattern="^[a-zA-Z0-9\s,-]+$" maxlength="50"
              title="Address" />
          </div>
          <div class="form-group">
            <label for="sh_city" class="control-label input-label">City</label>
            <input value="<%= @shipping.city %>" id="sh_city" name="city" type="text"
              placeholder="City" class="form-control" pattern="^[a-zA-Z]+$" maxlength="50"
              title="City" />
          </div>
          <div class="form-group">
            <label for="sh_zip" class="control-label input-label">Zip</label>
            <input value="<%= @shipping.zip %>" id="sh_zip" name="zip" type="text"
              placeholder="Zip" class="form-control" pattern="^[0-9-]+$" maxlength="8"
              title="Zip" />
          </div>
          <div class="form-group">
            <label for="sh_сountry" class="control-label input-label">Country</label>
            <select id="sh_country" name="country" placeholder="Country" class="form-control" pattern="^[A-Za-z]+$"
              maxlength="50" title="Country"
              <%= country_select :country, @shipping.country %>
            </select></div>
          <div class="form-group mb-60">
            <label for="sh_phone" class="control-label input-label">Phone</label>
            <input value="<%= @shipping.phone %>" id="sh_phone" name="phone" type="tel"
              placeholder="Phone" class="form-control" pattern="^\+\d{3,15}$" maxlength="15"
              title="Phone" />
          </div>

          <div class="form-group checkbox">
            <label class="checkbox-label">
              <input id="checkbox" type="checkbox" hidden="true" class="checkbox-input" name="checkbox"/>
                <span id="checkbox_icon"class="checkbox-icon"><i class="fa fa-check"></i></span>
                <span class="checkbox-text">Use Billing Adress</span>
            </label>
          </div>
        </div>
      </div>
      <div class="general-text-align mb-60">
        <p class="in-gold-500 font-18">Order Summary</p>
        <table class="general-summary-table">
          <tr>
            <td>
              <p class="font-16">Subtotal Summary</p>
            </td>
            <td>
              <p class="font-16">€
                <%= @cart.item_total_price %>
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <p class="font-16">Coupon discount</p>
            </td>
            <td>
              <p class="font-16">€
                <%= @cart.coupon %>
              </p>
            </td>
          </tr>
          <tr>
            <td>
              <strong class="font-18">Order Total</strong></td>
            <td>
              <strong class="font-18">€
                <%= @cart.item_total_price - @cart.coupon %></strong></td>
          </tr>
        </table>
      </div>
      <% end %>
      <a href="<%= url_for(:back) %>" class="general-back-link">
        <i class="fa fa-long-arrow-left mr-15"></i>Back</a>
      <button id="btn_continue" class="btn btn-default center-block mb-20" onclick="next_step('<%= next_wizard_path %>')">Save and Continue</button>
    </div>
  </div>
  <script>
    function next_step(path) {
      window.location.href = path;
    }
  </script>
</main>
